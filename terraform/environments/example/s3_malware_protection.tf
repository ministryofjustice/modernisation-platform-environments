## Example configuration provided as a reference for setting up GuardDuty Malware Protection - modify as needed.

# # GuardDuty Malware Protection Plan
# resource "aws_guardduty_malware_protection_plan" "malware_protection_plan" {
# # Specify the S3 buckets that should be protected by GuardDuty Malware Protection.
# # List each bucket name that requires malware scanning.
#    for_each = toset([
#     "malwarescanningtestkf",
#     "tests3scannningkaf"
#   ])

#   role = data.aws_iam_role.guardduty_malware_protection_role.arn

#   protected_resource {
#     s3_bucket {
#       bucket_name = each.key
#     }
#   }

#   actions {
#     tagging {
#       status = "ENABLED"
#     }
#   }

#   tags = {
#     "Name" = "GuardDutyMalwareProtectionPlan-${each.key}" # Unique tag for each bucket
#   }
# }
# data "aws_iam_role" "guardduty_malware_protection_role" {
#   name = "GuardDutyS3MalwareProtectionRole"
# }